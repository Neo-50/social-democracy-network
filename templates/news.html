{% extends 'base.html' %}

{% block content %}
<main class="news-page">

    <!-- Submission Form -->
    <section class="news-left">
        <h2>Submit a News Link</h2>
        <form method="POST" action="{{ url_for('news') }}">
            <input type="url" name="url" placeholder="Paste news article URL here..." required>
            <br><button type="submit">Submit</button>
        </form>
    </section>

    <!-- News Feed and Comments in unified right section -->
    <section class="news-right">
        {% for article in articles %}
        <div class="news-row">
            
            <!-- Article content -->
            <div class="news-item">
                {% if article.image_url %}
                <img src="{{ article.image_url }}" alt="Article image" class="news-image">
                {% endif %}

                {% if article.source %}
                <p class="news-source">Source: {{ article.source }}</p>
                {% endif %}

                {% if article.published %}
                <p class="news-published">Published: {{ article.published[:10] }}</p>
                {% endif %}

                <h3 class="news-title">
                    <a href="{{ article.url }}" target="_blank">{{ article.title or article.url }}</a>
                </h3>

                {% if article.authors %}
                <p class="news-authors">By {{ article.authors }}</p>
                {% endif %}

                {% if article.description %}
                <p class="news-description">{{ article.description }}</p>
                {% endif %}
            </div>

            <!-- Comment thread -->
            <div class="comments-thread">
                <h4>Discussion</h4>
                {% for comment in article.comments %}
                    <div class="comment">
                    <p>{{ comment.content }}</p>
                    <small>Posted {{ comment.timestamp.strftime('%b %d %Y, %I:%M %p') }}</small>
                    </div>
                {% endfor %}
                <form action="{{ url_for('add_comment', article_id=article.id) }}" method="post">
                    <textarea name="content" placeholder="Write a comment..." required></textarea>
                    <button type="submit">Post</button>
                </form>
            </div>

        </div>
        <hr class="article-divider">
        {% endfor %}
    </section>

</main>
{% endblock %}
